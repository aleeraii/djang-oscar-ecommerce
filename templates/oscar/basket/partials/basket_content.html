{% load i18n %}
{% load image_tags %}
{% load currency_filters %}
{% load purchase_info_tags %}
{% load widget_tweaks %}
{% load static %}


<!-- SHOPPING-CART-AREA START -->
<div class="shopping-cart-area  pt-80 pb-80">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="shopping-cart">
                    <!-- Nav tabs -->
                    <ul class="cart-page-menu nav row clearfix mb-30">
                        <li><a class="active" href="#shopping-cart" data-bs-toggle="tab">shopping cart</a></li>
<!--                        <li><a href="#wishlist" data-bs-toggle="tab">wishlist</a></li>-->
                    </ul>

                    <!-- Tab panes -->
                    <div class="tab-content">
                        <!-- shopping-cart start -->
                        <div class="tab-pane active" id="shopping-cart">
                      {% block basket_form_main %}

                        {% if basket_warnings %}
                            <h6 style="color:gray">{% trans "Important messages about items in your basket" %}</h6>
                            {% for warning in basket_warnings %}
                                <div class="alert alert-warning">{{ warning }}</div>
                            {% endfor %}
                        {% endif %}

                        {% if upsell_messages %}
                        <div class="shop-cart-table">
                            <h6 style="color:gray">{% trans "You could be missing out on offers!" %}</h6>
                            {% for upsell in upsell_messages %}
                                {% blocktrans with message=upsell.message url=upsell.offer.get_absolute_url offer_name=upsell.offer.name %}
                                    <div class="warning">{{ message }} to qualify for the <a href="{{ url }}">{{ offer_name }}</a> special offer</div>
                                {% endblocktrans %}
                            {% endfor %}
                        </div>
                        {% endif %}

                        <form method="post" class="basket_summary" id="basket_formset">
                            {% csrf_token %}
                            {{ formset.management_form }}
                            <div class="shop-cart-table">
                                <div class="table-content table-responsive">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th class="product-thumbnail">Product</th>
                                                <th class="product-price">Price</th>
                                                <th class="product-quantity">Quantity</th>
                                                <th class="product-subtotal">Total</th>
                                                <th class="product-remove">Remove</th>
                                            </tr>
                                        </thead>
                                        {% if not basket.is_empty %}

                                        {% for form in formset %}
                                            {% with line=form.instance product=form.instance.product %}
                                                {% purchase_info_for_line request line as session %}
                                                    <tbody>
                                                        <div class="basket-items">
                                                            <div class="row">
                                                                <tr>
                                                                    <td class="product-thumbnail text-left">
                                                                            <div class="single-product">
                                                                                <div class="product-img">
                                                                                    {{ form.id }}
                                                                                    {% with image=product.primary_image %}
                                                                                        {% oscar_thumbnail image.original "90x90" upscale=False as thumb %}
                                                                                            <a href="{{ product.get_absolute_url }}">
                                                                                                <img src="{{ thumb.url }}" alt="{{ product.get_title }}"/>
                                                                                            </a>
                                                                                        {% endwith %}
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        <div class="product-info">
                                                                            <h4 class="post-title"><a class="text-light-black" href="#">{{ line.description }}</a></h4>
                                                                            <p class="mb-0">{{ session.availability.message }}</p>
                                                                        </div>
                                                                    </td>

                                                                    <td class="product-price">
                                                                        {% if not line.unit_price_incl_tax and not line.unit_tax_excl_tax %}
                                                                            <p class="text-right">&mdash;</p>
                                                                        {% else %}
                                                                            <p class="price_color text-right">
                                                                                <span class="price-title d-md-none">{% trans "Price" %}:</span>
                                                                                {% if line.is_tax_known %}
                                                                                    {{ line.unit_price_incl_tax|currency:line.price_currency }}
                                                                                {% else %}
                                                                                    {{ line.unit_price_excl_tax|currency:line.price_currency }}
                                                                                {% endif %}
                                                                            </p>
                                                                        {% endif %}
                                                                    </td>

                                                                     <td>
                                                                        <div class="input-group {% if form.errors %}error{% endif %}">
                                                                            {% render_field form.quantity class="form-control" %}
                                                                            <div class="input-group-append">
                                                                                <button class="btn btn-secondary" type="submit" data-loading-text="{% trans 'Updating...' %}">{% trans "Update" %}</button>
                                                                            </div>
                                                                        </div>
                                                                  </td>

                                                                    <td class="product-subtotal">
                                                                            {% if not line.line_price_incl_tax and not line_price_excl_tax %}
                                                                                <p class="text-right">&mdash;</p>
                                                                            {% else %}
                                                                                <p class="price_color text-right">
                                                                                    <span class="price-title d-md-none">{% trans "Total" %}:</span>
                                                                                    {% if line.is_tax_known %}
                                                                                        {{ line.line_price_incl_tax|currency:line.price_currency }}
                                                                                    {% else %}
                                                                                        {{ line.line_price_excl_tax|currency:line.price_currency }}
                                                                                    {% endif %}
                                                                                </p>
                                                                            {% endif %}
                                                                    </td>

                                                                  <td class="product-remove">
                                                                        <a href="#" data-id="{{ forloop.counter0 }}" data-behaviours="remove">
                                                                            <i class="zmdi zmdi-close"></i>
                                                                        </a>
                                                                        <!-- Add the delete input here -->
                                                                        <input type="checkbox" id="id_form-{{ forloop.counter0 }}-DELETE" name="form-{{ forloop.counter0 }}-DELETE" value="on" style="display:none">
                                                                    </td>
                                                                </tr>
                                                            </div>
                                                        </div>
                                                    </tbody>
                                                {% endwith %}
                                            {% endfor %}
                                    {% else %}
                                            <p class="text-center">
                                                {% trans "Your basket is empty." %}
                                            </p>
                                    {% endif %}
                                    </table>
                                </div>
                            </div>
                        </form>
                    {% endblock %}
                        {% if not basket.is_empty %}
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="customer-login mt-30">
                                        <h4 class="title-1 title-border text-uppercase">coupon discount</h4>
                                        <p class="text-gray">Enter your coupon code if you have one!</p>
                                       <form id="voucher_form" action="{% url 'basket:vouchers-add' %}" method="post">
                                            {% csrf_token %}
                                            <input class="text-gray" type="text" name="code" placeholder="Enter your code here." maxlength="128" class="form-control" required="" id="id_code">
                                            <button type="submit" data-text="apply coupon" class="button-one submit-button mt-15">apply coupon</button>
                                        </form>
                                    </div>
                                </div>
                                {% block baskettotals %}
                                <div class="col-md-6">
                                    <div class="customer-login payment-details mt-30">
                                        <h4 class="title-1 title-border text-uppercase">payment details</h4>
                                        {% include 'oscar/basket/partials/basket_totals.html' with editable=1 %}
                                        <a href="{% url 'checkout:index' %}" data-text="checkout" class="button-one submit-button mt-15"><i class="fas fa-shopping-cart"></i> {% trans "Checkout" %}</a>
                                    </div>
                                </div>
                                {% endblock baskettotals %}
                            </div>
                         {% endif %}

<!--                            <div class="row">-->
<!--                                <div class="col-md-12">-->
<!--                                    <div class="customer-login mt-30">-->
<!--                                        <h4 class="title-1 title-border text-uppercase">culculate shipping</h4>-->
<!--                                        <p class="text-gray">Enter your coupon code if you have one!</p>-->
<!--                                        <div class="row">-->
<!--                                            <div class="col-md-4">-->
<!--                                                <input type="text" placeholder="Country">-->
<!--                                            </div>-->
<!--                                            <div class="col-md-4">-->
<!--                                                <input type="text" placeholder="Region / State">-->
<!--                                            </div>-->
<!--                                            <div class="col-md-4">-->
<!--                                                <input type="text" placeholder="Post code">-->
<!--                                            </div>-->
<!--                                        </div>-->
<!--                                        <button type="submit" data-text="get a quote" class="button-one submit-button mt-15">get a quote</button>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
                        </div>
                        <!-- shopping-cart end -->
                        <!-- wishlist start -->
<!--                        <div class="tab-pane" id="wishlist">-->
<!--                            <form action="#">-->
<!--                                <div class="shop-cart-table">-->
<!--                                    <div class="table-content table-responsive">-->
<!--                                        <table>-->
<!--                                            <thead>-->
<!--                                                <tr>-->
<!--                                                    <th class="product-thumbnail">Product</th>-->
<!--                                                    <th class="product-price">Price</th>-->
<!--                                                    <th class="product-stock">stock status</th>-->
<!--                                                    <th class="product-add-cart">Add to cart</th>-->
<!--                                                    <th class="product-remove">Remove</th>-->
<!--                                                </tr>-->
<!--                                            </thead>-->
<!--                                            <tbody>-->
<!--                                                <tr>-->
<!--                                                    <td class="product-thumbnail  text-left">-->
<!--                                                        &lt;!&ndash; Single-product start &ndash;&gt;-->
<!--                                                        <div class="single-product">-->
<!--                                                            <div class="product-img">-->
<!--                                                                <a href="single-product.html"><img src="img/product/2.jpg" alt="" /></a>-->
<!--                                                            </div>-->
<!--                                                            <div class="product-info">-->
<!--                                                                <h4 class="post-title"><a class="text-light-black" href="#">dummy product name</a></h4>-->
<!--                                                                <p class="mb-0">Color :  Black</p>-->
<!--                                                                <p class="mb-0">Size : SL</p>-->
<!--                                                            </div>-->
<!--                                                        </div>-->
<!--                                                        &lt;!&ndash; Single-product end &ndash;&gt;-->
<!--                                                    </td>-->
<!--                                                    <td class="product-price">$56.00</td>-->
<!--                                                    <td class="product-stock">in stock</td>-->
<!--                                                    <td class="product-add-cart">-->
<!--                                                        <a class="text-light-black" href="#"><i class="zmdi zmdi-shopping-cart-plus"></i></a>-->
<!--                                                    </td>-->
<!--                                                    <td class="product-remove">-->
<!--                                                        <a href="#"><i class="zmdi zmdi-close"></i></a>-->
<!--                                                    </td>-->
<!--                                                </tr>-->
<!--                                                <tr>-->
<!--                                                    <td class="product-thumbnail  text-left">-->
<!--                                                        &lt;!&ndash; Single-product start &ndash;&gt;-->
<!--                                                        <div class="single-product">-->
<!--                                                            <div class="product-img">-->
<!--                                                                <a href="single-product.html"><img src="img/product/12.jpg" alt="" /></a>-->
<!--                                                            </div>-->
<!--                                                            <div class="product-info">-->
<!--                                                                <h4 class="post-title"><a class="text-light-black" href="#">dummy product name</a></h4>-->
<!--                                                                <p class="mb-0">Color :  Black</p>-->
<!--                                                                <p class="mb-0">Size :     SL</p>-->
<!--                                                            </div>-->
<!--                                                        </div>-->
<!--                                                        &lt;!&ndash; Single-product end &ndash;&gt;-->
<!--                                                    </td>-->
<!--                                                    <td class="product-price">$56.00</td>-->
<!--                                                    <td class="product-stock">in stock</td>-->
<!--                                                    <td class="product-add-cart">-->
<!--                                                        <a class="text-light-black" href="#"><i class="zmdi zmdi-shopping-cart-plus"></i></a>-->
<!--                                                    </td>-->
<!--                                                    <td class="product-remove">-->
<!--                                                        <a href="#"><i class="zmdi zmdi-close"></i></a>-->
<!--                                                    </td>-->
<!--                                                </tr>-->
<!--                                                <tr>-->
<!--                                                    <td class="product-thumbnail  text-left">-->
<!--                                                        &lt;!&ndash; Single-product start &ndash;&gt;-->
<!--                                                        <div class="single-product">-->
<!--                                                            <div class="product-img">-->
<!--                                                                <a href="single-product.html"><img src="img/product/6.jpg" alt="" /></a>-->
<!--                                                            </div>-->
<!--                                                            <div class="product-info">-->
<!--                                                                <h4 class="post-title"><a class="text-light-black" href="#">dummy product name</a></h4>-->
<!--                                                                <p class="mb-0">Color :  Black</p>-->
<!--                                                                <p class="mb-0">Size :     SL</p>-->
<!--                                                            </div>-->
<!--                                                        </div>-->
<!--                                                        &lt;!&ndash; Single-product end &ndash;&gt;-->
<!--                                                    </td>-->
<!--                                                    <td class="product-price">$56.00</td>-->
<!--                                                    <td class="product-stock">in stock</td>-->
<!--                                                    <td class="product-add-cart">-->
<!--                                                        <a class="text-light-black" href="#"><i class="zmdi zmdi-shopping-cart-plus"></i></a>-->
<!--                                                    </td>-->
<!--                                                    <td class="product-remove">-->
<!--                                                        <a href="#"><i class="zmdi zmdi-close"></i></a>-->
<!--                                                    </td>-->
<!--                                                </tr>-->
<!--                                            </tbody>-->
<!--                                        </table>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </form>-->
<!--                        </div>-->
                        <!-- wishlist end -->
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- SHOPPING-CART-AREA END -->



{% block savedbasket %}
<!--    {% if user.is_authenticated and saved_formset %}-->
<!--        <div class="card card-body">-->
<!--            <div class="sub-header">-->
<!--                <h2>{% trans "Items to buy later" %}</h2>-->
<!--            </div>-->
<!--            <div class="row basket-title d-none d-md-flex">-->
<!--                <div class="col-md-8 h4">{% trans "Items" %}</div>-->
<!--                <div class="col-md-2 h4 text-center">{% trans "Price" %}</div>-->
<!--                <div class="col-md-2">&nbsp;</div>-->
<!--            </div>-->
<!--            <form action="{% url 'basket:saved' %}" method="post" id="saved_basket_formset">-->
<!--                {% csrf_token %}-->
<!--                {{ saved_formset.management_form }}-->
<!--                {% for form in saved_formset %}-->
<!--                    {% purchase_info_for_product request form.instance.product as session %}-->
<!--                    <div class="basket-items">-->
<!--                        <div class="row">-->
<!--                            <div class="col-md-2">-->
<!--                                {{ form.id }}-->
<!--                                {% with image=form.instance.product.primary_image %}-->
<!--                                    {% oscar_thumbnail image.original "100x100" upscale=False as thumb %}-->
<!--                                    <a href="{{ form.instance.product.get_absolute_url }}">-->
<!--                                        <img class="card card-body mx-auto" src="{{ thumb.url }}" alt="{{ form.instance.product.get_title }}">-->
<!--                                    </a>-->
<!--                                {% endwith %}-->
<!--                            </div>-->
<!--                            <div class="col-md-6">-->
<!--                                <h3><a href="{{ form.instance.product.get_absolute_url }}">{{ form.instance.description }}</a></h3>-->
<!--                                <p class="availability {{ session.availability.code }}">{{ session.availability.message }}</p>-->
<!--                                <a href="#" data-id="{{ forloop.counter0 }}" data-behaviours="remove">{% trans "Remove" %}</a>-->
<!--                                <div style="display:none">-->
<!--                                    {{ form.move_to_basket }}-->
<!--                                    {{ form.DELETE }}-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            {% purchase_info_for_product request form.instance.product as saved %}-->
<!--                            <div class="col-md-2 text-center">-->
<!--                                <p class="price_color">-->
<!--                                    {% if saved.price.is_tax_known %}-->
<!--                                        {{ saved.price.incl_tax|currency:saved.price.currency }}-->
<!--                                    {% else %}-->
<!--                                        {{ saved.price.excl_tax|currency:saved.price.currency }}-->
<!--                                    {% endif %}-->
<!--                                </p>-->
<!--                            </div>-->
<!--                            <div class="col-md-2">-->
<!--                                <a href="#" data-id="{{ forloop.counter0 }}" class="btn float-right btn-block" data-behaviours="move">{% trans "Move to basket" %}</a>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                {% endfor %}-->
<!--            </form>-->
<!--        </div>-->
<!--    {% endif %}-->

{% endblock %}
